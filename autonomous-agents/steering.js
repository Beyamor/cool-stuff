// Generated by CoffeeScript 1.3.3
(function() {
  var Steerer;

  Steerer = (function() {

    function Steerer(game, settings, entity) {
      this.game = game;
      this.settings = settings;
      this.entity = entity;
      this.isOn = {
        seek: false,
        arrive: true
      };
    }

    Steerer.prototype.force = function() {
      var desiredVelocity, distance, force, maxForce, maxSpeed, speed, targetPos, toTarget;
      force = new Vec2;
      targetPos = this.game.mousePos;
      toTarget = targetPos.minus(this.entity.pos);
      maxSpeed = this.settings.forEntity.maxSpeed;
      maxForce = this.settings.forSteering.maxForce;
      if (this.isOn["seek"]) {
        desiredVelocity = toTarget.normal().scaleBy(maxSpeed);
        force = desiredVelocity.minus(this.entity.vel);
      }
      if (this.isOn["arrive"]) {
        distance = toTarget.length();
        if (distance > 0) {
          speed = Math.min(maxSpeed, distance);
          desiredVelocity = toTarget.normal().scaleBy(speed);
          force = desiredVelocity.minus(this.entity.vel);
        }
      }
      return force.clamp(maxForce);
    };

    return Steerer;

  })();

  window.Steerer = Steerer;

}).call(this);
